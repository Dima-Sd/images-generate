<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8" />
    <title>–§–æ—Ä–º–∞ –≤—Ö–æ–¥—É</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css" />
</head>

<body>
    <div class="wrapper">
        <div class="container">
            <form class="form" id="loginForm" novalidate>
                <h3 class="form__title">–í—Ö—ñ–¥ —É —Å–∏—Å—Ç–µ–º—É</h3>

                <label class="form__label" for="email">
                    Email
                    <input class="form__input" type="email" id="email" />
                    <div class="error-message" id="emailError"></div> <!-- ‚úÖ -->
                </label>

                <label class="form__label" for="password">
                    –ü–∞—Ä–æ–ª—å
                    <input class="form__input" type="password" id="password" />
                    <div class="error-message" id="passwordError"></div> <!-- ‚úÖ -->
                </label>

                <button class="button form__button" type="submit">–£–≤—ñ–π—Ç–∏</button>
            </form>

            <div class="form__label" id="message"></div>
        </div>
    </div>
    <script>
        const form = document.getElementById('loginForm');

        form.addEventListener('submit', async function (e) {
            e.preventDefault();

            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            const emailError = document.getElementById('emailError');
            const passwordError = document.getElementById('passwordError');

            const email = emailInput.value.trim();
            const password = passwordInput.value.trim();

            // –û—á–∏—Å—Ç–∏—Ç–∏ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
            emailInput.style.backgroundColor = '';
            passwordInput.style.backgroundColor = '';
            emailError.textContent = '';
            passwordError.textContent = '';

            let isValid = true;

            // –í–∞–ª—ñ–¥–∞—Ü—ñ—è email
            if (!email.includes('@')) {
                emailInput.style.backgroundColor = '#fdd';
                emailError.textContent = 'üìß –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π email';
                isValid = false;
            }

            // –í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø–∞—Ä–æ–ª—è
            if (password.length < 6) {
                passwordInput.style.backgroundColor = '#fdd';
                passwordError.textContent = 'üîê –ü–∞—Ä–æ–ª—å –º–∞—î –±—É—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 6 —Å–∏–º–≤–æ–ª—ñ–≤';
                isValid = false;
            }

            if (!isValid) return;

            try {
                const res = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password }),
                });

                const data = await res.json();
                if (res.ok) {
                    window.location.href = '/dashboard.html';
                } else {
                    passwordError.textContent = data.message || '‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É';
                }
            } catch (err) {
                passwordError.textContent = '‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π';
            }
        });
    </script>


</body>

</html>