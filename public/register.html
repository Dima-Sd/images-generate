<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8" />
    <title>–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css" />
</head>

<body>
    <div class="wrapper">
        <div class="container">
            <form class="form" id="registerForm" novalidate>
                <h3 class="form__title">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h3>

                <label class="form__label" for="email">
                    Email
                    <input class="form__input" type="email" id="email" />
                    <div class="error-message" id="emailError"></div>
                </label>

                <label class="form__label" for="password">
                    –ü–∞—Ä–æ–ª—å
                    <input class="form__input" type="password" id="password" />
                    <div class="error-message" id="passwordError"></div>
                </label>

                <button class="button form__button" type="submit">–ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</button>
            </form>
        </div>
    </div>

    <script>
        const form = document.getElementById('registerForm');

        form.addEventListener('submit', async function (e) {
            e.preventDefault();

            const emailInput = document.getElementById('email');
            const passwordInput = document.getElementById('password');
            const emailError = document.getElementById('emailError');
            const passwordError = document.getElementById('passwordError');

            const email = emailInput.value.trim();
            const password = passwordInput.value.trim();

            emailInput.style.backgroundColor = '';
            passwordInput.style.backgroundColor = '';
            emailError.textContent = '';
            passwordError.textContent = '';

            let isValid = true;

            if (!email.includes('@')) {
                emailInput.style.backgroundColor = '#fdd';
                emailError.textContent = 'üìß –í–≤–µ–¥—ñ—Ç—å –∫–æ—Ä–µ–∫—Ç–Ω–∏–π email';
                isValid = false;
            }

            if (password.length < 6) {
                passwordInput.style.backgroundColor = '#fdd';
                passwordError.textContent = 'üîê –ü–∞—Ä–æ–ª—å –º–∞—î –±—É—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 6 —Å–∏–º–≤–æ–ª—ñ–≤';
                isValid = false;
            }

            if (!isValid) return;

            try {
                const res = await fetch('/api/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password }),
                });

                const data = await res.json();
                if (res.ok) {
                    emailInput.value = '';
                    passwordInput.value = '';
                    alert('‚úÖ –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —É—Å–ø—ñ—à–Ω–∞. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–æ—à—Ç—É.');
                } else {
                    passwordError.textContent = data.message || '‚ùå –ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó';
                }
            } catch (err) {
                passwordError.textContent = '‚ö†Ô∏è –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π';
            }
        });
    </script>
</body>

</html>